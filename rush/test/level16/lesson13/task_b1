package com.javarush.test.level16.lesson13.bonus03;
/* –û—Ç–¥–µ–±–∞–∂–∏–º –≤—Å–µ –Ω–∞ —Å–≤–µ—Ç–µ
–†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–∞.
–ü–æ—á–∏—Ç–∞—Ç—å –ø—Ä–æ UncaughtExceptionHandler - —ç—Ç–æ –≤–∞–∂–Ω–æ.
–ï—â–µ —Ä–∞–∑ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É.
–†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è - –ø—Ä–æ–¥–µ–±–∞–∂–∏—Ç—å - –ø–æ—á–µ–º—É –Ω–∞—à OurUncaughtExceptionHandler –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç.
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É, —Ç.–µ. –≤—Å–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. <img draggable="false" class="emoji" alt="üôÇ" src="https://s.w.org/images/core/emoji/72x72/1f642.png">
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
–ù–∏—Ç—å 1: My exception message
–ù–∏—Ç—å 2: My exception message
*/
public class Solution {
    public static Thread.UncaughtExceptionHandler handler = new OurUncaughtExceptionHandler();
    public static void main(String[] args) {
        TestedThread commonThread = new TestedThread(handler);
        Thread threadA = new Thread(commonThread, "–ù–∏—Ç—å 1");
        Thread threadB = new Thread(commonThread, "–ù–∏—Ç—å 2");
        threadA.start();
        threadB.start();
        threadA.setUncaughtExceptionHandler(handler);   //—ç—Ç–∏ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏ –Ω—É–∂–Ω–æ –±—ã–ª–æ –¥–æ–ø–∏—Å–∞—Ç—å
        threadB.setUncaughtExceptionHandler(handler);
        threadA.interrupt();
        threadB.interrupt();
    }
    public static class TestedThread extends Thread {
        public TestedThread(UncaughtExceptionHandler handler) {
            setUncaughtExceptionHandler(handler);
            start();
        }
        public void run() {
            try {
                Thread.sleep(3000);
            } catch (InterruptedException x) {
                throw new RuntimeException("My exception message");
            }
        }
    }
    public static class OurUncaughtExceptionHandler implements Thread.UncaughtExceptionHandler {
        @Override
        public void uncaughtException(Thread t, Throwable e) {
            System.out.println(t.getName() + ": " + e.getMessage());
        }
    }
}
